GI|PBS|BP12,TDN6,UVN12,AV12,BA12,VIR12,NV12,NEW|Points Summary|Max voucher total (maximum voucher total a customer has got in their statement)|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK)Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID Inner Join ( select MAX(p1.NumberofVouchers) NumberofVouchers , m1.basestock from PointDetails p1  Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID group by m1.basestock) i on  i.basestock = m.basestock and i.NumberofVouchers = p.NumberofVouchers WHERE m.HouseholdID IS NOT NULL
GI|PBS|BP12,TDN6,UVN12,AV12,BA12,VIR12,NV12,NEW|Points Summary|Max total points|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK)Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID Inner Join ( select MAX(p1.TotalPoints) TotalPoints , m1.basestock from PointDetails p1  Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID group by m1.basestock) i on  i.basestock = m.basestock and i.TotalPoints = p.TotalPoints WHERE m.HouseholdID IS NOT NULL
GI|PBS|BP12,TDN6,UVN12,AV12,BA12,VIR12,NV12,NEW|Points Summary|149 points carried forward to your next statement|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK)Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID Where p. TescoCarriedForwardPoints in (select TescoCarriedForwardPoints From PointDetails WITH(NOLOCK) where TescoCarriedForwardPoints =149 )
GI|PBS|BP12,TDN6,UVN12,AV12,BA12,VIR12,NV12,NEW|Points Summary|0 points carried forward to your next statement|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK)Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID Where p. TescoCarriedForwardPoints in (select TescoCarriedForwardPoints From PointDetails WITH(NOLOCK) where TescoCarriedForwardPoints =0 )
GI|PBS|BP12,TDN6,UVN12,AV12,BA12,VIR12,NV12,NEW|Points Summary|Max points collected with Tesco|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK)Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID Inner Join ( select MAX(p1.TescoPoints) TescoPoints , m1.basestock from PointDetails p1  Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID group by m1.basestock) i on  i.basestock = m.basestock and i.TescoPoints = p.TescoPoints WHERE m.HouseholdID IS NOT NULL
GI|PBS|BP12,TDN6,UVN12,AV12,BA12,VIR12,NV12,NEW|Points Summary|0 points collected with Tesco|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK)Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID Where p.TescoPoints in (select TescoPoints From PointDetails WITH(NOLOCK) where TescoPoints =0 ) 
GI|PBS|BP12,TDN6,UVN12,AV12,BA12,VIR12,NV12,NEW|Points Summary|Max points collected with Tesco Bank|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK)Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID Inner Join ( select MAX(p1.TescoBankPoints) TescoBankPoints , m1.basestock from PointDetails p1  Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID group by m1.basestock) i on  i.basestock = m.basestock and i.TescoBankPoints = p.TescoBankPoints WHERE m.HouseholdID IS NOT NULL
GI|PBS|BP12,TDN6,UVN12,AV12,BA12,VIR12,NV12,NEW|Points Summary|0 points collected with Tesco Bank|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK)Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID Where p.TescoBankPoints in (select TescoBankPoints From PointDetails WITH(NOLOCK) where TescoBankPoints =0 ) 
COMMUNISIS|PBS|BDC,BPC,TD6,HV12,CSVO,CSVT,CSVTB,CSTO,CSTB,CSC|Points Summary|Max voucher total (maximum voucher total a customer has got in their statement)|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK)Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID Inner Join ( select MAX(p1.NumberofVouchers) NumberofVouchers , m1.basestock from PointDetails p1  Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID group by m1.basestock) i on  i.basestock = m.basestock and i.NumberofVouchers = p.NumberofVouchers WHERE m.HouseholdID IS NOT NULL
COMMUNISIS|PBS|BDC,BPC,TD6,HV12,CSVO,CSVT,CSVTB,CSTO,CSTB,CSC|Points Summary|Max total points|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK)Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID Inner Join ( select MAX(p1.TotalPoints) TotalPoints , m1.basestock from PointDetails p1  Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID group by m1.basestock) i on  i.basestock = m.basestock and i.TotalPoints = p.TotalPoints WHERE m.HouseholdID IS NOT NULL
COMMUNISIS|PBS|BDC,BPC,TD6,HV12,CSVO,CSVT,CSVTB,CSTO,CSTB,CSC|Points Summary|149 points carried forward to your next statement|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK)Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID Where p. TescoCarriedForwardPoints in (select TescoCarriedForwardPoints From PointDetails WITH(NOLOCK) where TescoCarriedForwardPoints =149 )
COMMUNISIS|PBS|BDC,BPC,TD6,HV12,CSVO,CSVT,CSVTB,CSTO,CSTB,CSC|Points Summary|0 points carried forward to your next statement|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK)Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID Where p. TescoCarriedForwardPoints in (select TescoCarriedForwardPoints From PointDetails WITH(NOLOCK) where TescoCarriedForwardPoints =0 )
COMMUNISIS|PBS|BDC,BPC,TD6,HV12,CSVO,CSVT,CSVTB,CSTO,CSTB,CSC|Points Summary|Max points collected with Tesco|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK)Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID Inner Join ( select MAX(p1.TescoPoints) TescoPoints , m1.basestock from PointDetails p1  Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID group by m1.basestock) i on  i.basestock = m.basestock and i.TescoPoints = p.TescoPoints WHERE m.HouseholdID IS NOT NULL
COMMUNISIS|PBS|BDC,BPC,TD6,HV12,CSVO,CSVT,CSVTB,CSTO,CSTB,CSC|Points Summary|0 points collected with Tesco|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK)Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID Where p.TescoPoints in (select TescoPoints From PointDetails WITH(NOLOCK) where TescoPoints =0 ) 
COMMUNISIS|PBS|BDC,BPC,TD6,HV12,CSVO,CSVT,CSVTB,CSTO,CSTB,CSC|Points Summary|Max points collected with Tesco Bank|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK)Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID Inner Join ( select MAX(p1.TescoBankPoints) TescoBankPoints , m1.basestock from PointDetails p1  Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID group by m1.basestock) i on  i.basestock = m.basestock and i.TescoBankPoints = p.TescoBankPoints WHERE m.HouseholdID IS NOT NULL
COMMUNISIS|PBS|BDC,BPC,TD6,HV12,CSVO,CSVT,CSVTB,CSTO,CSTB,CSC|Points Summary|0 points collected with Tesco Bank|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK)Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID Where p.TescoBankPoints in (select TescoBankPoints From PointDetails WITH(NOLOCK) where TescoBankPoints =0 ) 
