GI|SALA|BP12|Salutation Associate Rules|Main has SPECIAL title, Associate does not|select TOP 1 p.HouseholdID,m.ClubCardID  from PointDetails p WITH(NOLOCK) Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID inner join AssociateCustomerDetails ac WITH(NOLOCK) ON m.HouseholdID = ac.HouseholdID where m.CustomerTitle in ('Lady','Laird','Lord','Sir','Sister','DUKE','Duchess','DUCH') and ac.TitleEnglish not in ('Lady','Laird','Lord','Sir','Sister','DUKE','Duchess','DUCH') 
GI|SALA|BP12|Salutation Associate Rules|Associate has SPECIAL title, Main does not|select TOP 1 p.HouseholdID,m.ClubCardID from PointDetails p WITH(NOLOCK) Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID inner join AssociateCustomerDetails ac WITH(NOLOCK) ON m.HouseholdID = ac.HouseholdID where m.CustomerTitle not in ('Lady','Laird','Lord','Sir','Sister','DUKE','Duchess','DUCH') and ac.TitleEnglish in ('Lady','Laird','Lord','Sir','Sister','DUKE','Duchess','DUCH') 
GI|SALA|BP12|Salutation Associate Rules|Both Main and Associate have SPECIAL titles and same class of titles (e.g.Lord & Lady)|select TOP 1 p.HouseholdID,m.ClubCardID from PointDetails p WITH(NOLOCK) Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID inner join AssociateCustomerDetails ac WITH(NOLOCK) ON m.HouseholdID = ac.HouseholdID where m.CustomerTitle  in ('Lady','Laird','Lord','Sir','Sister','DUKE','Duchess','DUCH') and ac.TitleEnglish in ('Lady','Laird','Lord','Sir','Sister','DUKE','Duchess','DUCH') 
GI|SALA|BP12|Salutation Associate Rules|Both Main and Associate have SPECIAL titles, but different class of titles (e.g.Lord & Dr)|select TOP 1 p.HouseholdID,m.ClubCardID from PointDetails p WITH(NOLOCK) Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID inner join AssociateCustomerDetails ac WITH(NOLOCK) ON m.HouseholdID = ac.HouseholdID where ((m.CustomerTitle in ('Lady','Laird','Lord','Sir','Sister','DUKE','Duchess','DUCH') and ac.TitleEnglish in ('Professor','Doctor')) OR (m.CustomerTitle  in ('Professor','Doctor') and ac.TitleEnglish in ('Lady','Laird','Lord','Sir','Sister','DUKE','Duchess','DUCH')))
GI|SALA|BP12|Salutation Associate Rules|Main has MILITARY title, Associate does not|select TOP 1 p.HouseholdID,m.ClubCardID from PointDetails p WITH(NOLOCK) Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID inner join AssociateCustomerDetails ac WITH(NOLOCK) ON m.HouseholdID = ac.HouseholdID where m.CustomerTitle  in ('Captain','Colonel','Commander','Lieutenant','Lieutenant Colonel','Lieutenant Commander') and ac.TitleEnglish not in ('Captain','Colonel','Commander','Lieutenant','Lieutenant Colonel','Lieutenant Commander') 
GI|SALA|BP12|Salutation Associate Rules|Associate has MILITARY title, Main does not|select TOP 1 p.HouseholdID,m.ClubCardID from PointDetails p WITH(NOLOCK) Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID inner join AssociateCustomerDetails ac WITH(NOLOCK) ON m.HouseholdID = ac.HouseholdID where m.CustomerTitle  not in ('Captain','Colonel','Commander','Lieutenant','Lieutenant Colonel','Lieutenant Commander') and ac.TitleEnglish in ('Captain','Colonel','Commander','Lieutenant','Lieutenant Colonel','Lieutenant Commander')  
GI|SALA|BP12|Salutation Associate Rules|Customer where Main title is blank, Associate is not|select TOP 1 p.HouseholdID,m.ClubCardID from PointDetails p WITH(NOLOCK) Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID inner join AssociateCustomerDetails ac WITH(NOLOCK) ON m.HouseholdID = ac.HouseholdID where isnull(m.CustomerTitle,'')='' and isnull(ac.TitleEnglish,'')!='' 
GI|SALA|BP12|Salutation Associate Rules|Customer where Associate title is blank, Main is not|select TOP 1 p.HouseholdID,m.ClubCardID from PointDetails p WITH(NOLOCK) Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID inner join AssociateCustomerDetails ac WITH(NOLOCK) ON m.HouseholdID = ac.HouseholdID where isnull(m.CustomerTitle,'')!='' and isnull(ac.TitleEnglish,'')='' 
COMMUNISIS|SALA|BD12|Salutation Associate Rules|Main has SPECIAL title, Associate does not|select TOP 1 p.HouseholdID,m.ClubCardID from PointDetails p WITH(NOLOCK) Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID inner join AssociateCustomerDetails ac WITH(NOLOCK) ON m.HouseholdID = ac.HouseholdID where m.CustomerTitle in ('Lady','Laird','Lord','Sir','Sister','DUKE','Duchess','DUCH') and ac.TitleEnglish not in ('Lady','Laird','Lord','Sir','Sister','DUKE','Duchess','DUCH') 
COMMUNISIS|SALA|BD12|Salutation Associate Rules|Associate has SPECIAL title, Main does not|select TOP 1 p.HouseholdID,m.ClubCardID from PointDetails p WITH(NOLOCK) Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID inner join AssociateCustomerDetails ac WITH(NOLOCK) ON m.HouseholdID = ac.HouseholdID where m.CustomerTitle not in ('Lady','Laird','Lord','Sir','Sister','DUKE','Duchess','DUCH') and ac.TitleEnglish in ('Lady','Laird','Lord','Sir','Sister','DUKE','Duchess','DUCH') 
COMMUNISIS|SALA|BD12|Salutation Associate Rules|Both Main and Associate have SPECIAL titles and same class of titles (e.g.Lord & Lady)|select TOP 1 p.HouseholdID,m.ClubCardID from PointDetails p WITH(NOLOCK) Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID inner join AssociateCustomerDetails ac WITH(NOLOCK) ON m.HouseholdID = ac.HouseholdID where m.CustomerTitle  in ('Lady','Laird','Lord','Sir','Sister','DUKE','Duchess','DUCH') and ac.TitleEnglish in ('Lady','Laird','Lord','Sir','Sister','DUKE','Duchess','DUCH') 
COMMUNISIS|SALA|BD12|Salutation Associate Rules|Both Main and Associate have SPECIAL titles, but different class of titles (e.g.Lord & Dr)|select TOP 1 p.HouseholdID,m.ClubCardID from PointDetails p WITH(NOLOCK) Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID inner join AssociateCustomerDetails ac WITH(NOLOCK) ON m.HouseholdID = ac.HouseholdID where ((m.CustomerTitle in ('Lady','Laird','Lord','Sir','Sister','DUKE','Duchess','DUCH') and ac.TitleEnglish in ('Professor','Doctor')) OR ( m.CustomerTitle  in ('Professor','Doctor') and ac.TitleEnglish in ('Lady','Laird','Lord','Sir','Sister','DUKE','Duchess','DUCH')))
COMMUNISIS|SALA|BD12|Salutation Associate Rules|Main has MILITARY title, Associate does not|select TOP 1 p.HouseholdID,m.ClubCardID from PointDetails p WITH(NOLOCK) Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID inner join AssociateCustomerDetails ac WITH(NOLOCK) ON m.HouseholdID = ac.HouseholdID where m.CustomerTitle  in ('Captain','Colonel','Commander','Lieutenant','Lieutenant Colonel','Lieutenant Commander') and ac.TitleEnglish not in ('Captain','Colonel','Commander','Lieutenant','Lieutenant Colonel','Lieutenant Commander')  
COMMUNISIS|SALA|BD12|Salutation Associate Rules|Associate has MILITARY title, Main does not|select TOP 1 p.HouseholdID,m.ClubCardID from PointDetails p WITH(NOLOCK) Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID inner join AssociateCustomerDetails ac WITH(NOLOCK) ON m.HouseholdID = ac.HouseholdID where m.CustomerTitle  not in ('Captain','Colonel','Commander','Lieutenant','Lieutenant Colonel','Lieutenant Commander') and ac.TitleEnglish in ('Captain','Colonel','Commander','Lieutenant','Lieutenant Colonel','Lieutenant Commander')  
COMMUNISIS|SALA|BD12|Salutation Associate Rules|Customer where Main title is blank, Associate is not|select TOP 1 p.HouseholdID,m.ClubCardID from PointDetails p WITH(NOLOCK) Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID inner join AssociateCustomerDetails ac WITH(NOLOCK) ON m.HouseholdID = ac.HouseholdID where isnull(m.CustomerTitle,'')='' and isnull(ac.TitleEnglish,'')!='' 
COMMUNISIS|SALA|BD12|Salutation Associate Rules|Customer where Associate title is blank, Main is not|select TOP 1 p.HouseholdID,m.ClubCardID from PointDetails p WITH(NOLOCK) Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID inner join AssociateCustomerDetails ac WITH(NOLOCK) ON m.HouseholdID = ac.HouseholdID where isnull(m.CustomerTitle,'')!='' and isnull(ac.TitleEnglish,'')='' 
