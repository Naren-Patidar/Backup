GI|SALD|BP12,TDN12,TDN6,UV12,UVC,UVN12,AV12,BA12,VIR12,NV12,NVC,NEW,NNV|Salutaion Display|Check max salutation|select TOP 1 m.HouseholdID, m.ClubcardID from PointDetails p WITH(NOLOCK)Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID Inner Join (Select MAX(LEN(m1.CustomerTitle + m1.customername3 + m1.CustomerName1 + m1.CustomerName2)) MaxSalutation, m1.Basestock  From MailableCustomers m1 group by m1.Basestock) i ON i.Basestock=m.Basestock AND i.MaxSalutation=LEN(m.CustomerTitle + m.customername3 + m.CustomerName1 + m.CustomerName2) Where m.HouseholdID IS NOT NULL      
COMMUNISIS|SALD|BD12,BDC,BPC,TD12,TD6,HV12,CSVO,CSVT,CSTB|Salutaion Display|Check max salutation|select TOP 1 m.HouseholdID, m.ClubcardID from PointDetails p WITH(NOLOCK)Inner Join MailableCustomers m WITH(NOLOCK) ON m.HouseholdID = p.HouseholdID Inner Join (Select MAX(LEN(m1.CustomerTitle + m1.customername3 + m1.CustomerName1 + m1.CustomerName2)) MaxSalutation, m1.Basestock  From MailableCustomers m1 group by m1.Basestock) i ON i.Basestock=m.Basestock AND i.MaxSalutation=LEN(m.CustomerTitle + m.customername3 + m.CustomerName1 + m.CustomerName2) Where m.HouseholdID IS NOT NULL      
