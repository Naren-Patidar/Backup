GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|Max points collected for Avios high rate customer|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK)on m.HouseholdID = p.HouseholdID inner join(select max(isnull(TotalPoints,0)) TotalPoints,m1.basestock from PointDetails p1 WITH(NOLOCK)Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID AND m1.airmilespremium='1' group by m1.basestock)i on i.basestock = m.basestock and i.TotalPoints=p.TotalPoints where m.HouseholdID IS NOT NULL  
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|Min points collected for Avios high rate customer|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID inner join(select min(isnull(TotalPoints,0))TotalPoints,m1.basestock from PointDetails p1 WITH(NOLOCK)Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID AND m1.airmilespremium='1' group by m1.basestock)i on i.basestock = m.basestock and i.TotalPoints=p.TotalPoints where m.HouseholdID IS NOT NULL 
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|Max points converted for Avios high rate  customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID inner join(select max(p1.TescoRewardMiles + p1.TescoBankRewardMiles) TotalRewardMiles,m1.basestock from PointDetails p1 WITH(NOLOCK)Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID AND m1.airmilespremium='1'group by m1.basestock)i on i.basestock = m.basestock and i.TotalRewardMiles=(p.TescoRewardMiles + p.TescoBankRewardMiles) where m.HouseholdID IS NOT NULL 
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|0 Avios for Avios high rate customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID where m.AirmilesPremium = '1' and p.TescoRewardMiles = 0 and p.TescoBankRewardMiles = 0 
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|Max points collected for Avios low rate customer|select top 1 m.HouseholdID, m.ClubcardID  from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID inner join(select max(p1.TotalPoints) TotalPoints,m1.basestock from PointDetails p1 WITH(NOLOCK)Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID AND m1.AirmilesStandard='1' group by m1.basestock)i on i.basestock = m.basestock and i.TotalPoints=p.TotalPoints where m.HouseholdID IS NOT NULL
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|Min points collected for Avios low rate customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID inner join(select min(p1.TotalPoints) TotalPoints,m1.basestock from PointDetails p1 WITH(NOLOCK)Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID AND m1.AirmilesStandard='1' group by m1.basestock)i on i.basestock = m.basestock and i.TotalPoints=p.TotalPoints where m.HouseholdID IS NOT NULL
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|Max points converted for Avios low rate customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID inner join(select max(p1.TescoRewardMiles + p1.TescoBankRewardMiles) TotalRewardMiles,m1.basestock from PointDetails p1 WITH(NOLOCK)Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID AND m1.AirmilesStandard='1' group by m1.basestock)i on i.basestock = m.basestock and i.TotalRewardMiles=(p.TescoRewardMiles + p.TescoBankRewardMiles) where m.HouseholdID IS NOT NULL
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|0 Avios for Avios low rate customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID where m.AirmilesStandard = '1' and p.TescoRewardMiles = 0 and p.TescoBankRewardMiles = 0
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|Max points collected for BA Avios high rate customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID inner join(select max(p1.TotalPoints) TotalPoints,m1.basestock from PointDetails p1 WITH(NOLOCK)Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID AND m1.BAMilesPremium='1' group by m1.basestock)i on i.basestock = m.basestock and i.TotalPoints=p.TotalPoints where m.HouseholdID IS NOT NULL 
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|Min points collected for BA Avios high rate customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID inner join(select min(p1.TotalPoints) TotalPoints,m1.basestock from PointDetails p1 WITH(NOLOCK)Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID AND m1.BAMilesPremium='1' group by m1.basestock)i on i.basestock = m.basestock and i.TotalPoints=p.TotalPoints where m.HouseholdID IS NOT NULL 
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|Max points converted for BA Avios high rate  customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID inner join(select max(p1.TescoRewardMiles + p1.TescoBankRewardMiles) TotalRewardMiles,m1.basestock from PointDetails p1 WITH(NOLOCK)Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID AND m1.BAMilesPremium='1' group by m1.basestock)i on i.basestock = m.basestock and i.TotalRewardMiles=(p.TescoRewardMiles + p.TescoBankRewardMiles) where m.HouseholdID IS NOT NULL 
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|0 Avios for BA Avios high rate customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID where m.BAMilesPremium = '1' and p.TescoRewardMiles = 0 and p.TescoBankRewardMiles = 0 
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|Max points collected for BA Avios low rate customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID inner join(select max(p1.TotalPoints) TotalPoints,m1.basestock from PointDetails p1 WITH(NOLOCK)Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID AND m1.BAMilesStandard='1' group by m1.basestock)i on i.basestock = m.basestock and i.TotalPoints=p.TotalPoints where m.HouseholdID IS NOT NULL 
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|Min points collected for BA Avios low rate customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID inner join(select min(p1.TotalPoints) TotalPoints,m1.basestock from PointDetails p1 WITH(NOLOCK)Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID AND m1.BAMilesStandard='1' group by m1.basestock)i on i.basestock = m.basestock and i.TotalPoints=p.TotalPoints where m.HouseholdID IS NOT NULL
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|Max points converted for BA Avios low rate  customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID inner join(select max(p1.TescoRewardMiles + p1.TescoBankRewardMiles) TotalRewardMiles,m1.basestock from PointDetails p1 WITH(NOLOCK)Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID AND  m1.BAMilesStandard='1' group by m1.basestock)i on i.basestock = m.basestock and i.TotalRewardMiles=(p.TescoRewardMiles + p.TescoBankRewardMiles) where m.HouseholdID IS NOT NULL
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|0 Avios for BA Avios low rate customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID where m.BAMilesStandard = '1' and p.TescoRewardMiles = 0 and p.TescoBankRewardMiles = 0
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|Max points collected for Virgin customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID inner join(select max(p1.TotalPoints) TotalPoints,m1.basestock from PointDetails p1 WITH(NOLOCK)Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID AND m1.VirginAtlantic='1' group by m1.basestock)i on i.basestock = m.basestock and i.TotalPoints=p.TotalPoints where m.HouseholdID IS NOT NULL   
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|Min points collected for Virgin customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID inner join(select min(p1.TotalPoints) TotalPoints,m1.basestock from PointDetails p1 WITH(NOLOCK)Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID AND m1.VirginAtlantic='1' group by m1.basestock)i on i.basestock = m.basestock and i.TotalPoints=p.TotalPoints where m.HouseholdID IS NOT NULL 
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|Max points converted for Virgin  customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID inner join(select max(p1.TescoRewardMiles + p1.TescoBankRewardMiles) TotalRewardMiles,m1.basestock from PointDetails p1 WITH(NOLOCK)Inner Join MailableCustomers m1 WITH(NOLOCK) ON m1.HouseholdID = p1.HouseholdID AND m1.VirginAtlantic='1' group by m1.basestock)i on i.basestock = m.basestock and i.TotalRewardMiles=(p.TescoRewardMiles + p.TescoBankRewardMiles) where m.HouseholdID IS NOT NULL
GI|WYC|AV12,AVC,BA12,BAC,VIR12,VIRC|What You've Collected|0 Miles for Virgin customer|select top 1 m.HouseholdID, m.ClubcardID from MailableCustomers m WITH(NOLOCK) Inner Join PointDetails p WITH(NOLOCK) on m.HouseholdID = p.HouseholdID where m.VirginAtlantic = '1' and p.TescoRewardMiles = 0 and p.TescoBankRewardMiles = 0 